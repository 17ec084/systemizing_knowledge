<!DOCTYPE HTML>
<html lang="ja">
<head>
<!-- 17ec084 safe_title --><title>テスト</title><!-- 17ec084 end safe_title -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
<canvas id="cv" width="5000" height="5000" style="border: 1px solid #333333;"></canvas>
<input type="text" id="png">
<!-- 17ec084 safe_script --><script>
ctx = document.getElementById("cv").getContext("2d");
ctx.strokeStyle = "#000000";
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.beginPath();
ctx.moveTo(1509, 3517);
ctx.lineTo(3508, 3482);
ctx.lineTo(3491, 2483);
ctx.lineTo(1492, 2518);
ctx.closePath();
ctx.lineWidth = 100;
ctx.stroke();
ctx.fillStyle = "#ffffcc";
ctx.fill();
ctx.restore();
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.beginPath();
ctx.moveTo(2147, 4060);
ctx.lineTo(3560, 2647);
ctx.lineTo(2853, 1940);
ctx.lineTo(1440, 3353);
ctx.closePath();
ctx.strokeStyle = "#ff0000";
ctx.stroke();
ctx.fillStyle = "#ccffff";
ctx.fill();
ctx = document.getElementById("cv").getContext("2d");
ctx.font = "100px 'ＭＳ ゴシック'";
ctx.textAlign = "center";
ctx.textBaseline = "middle";
ctx.fillStyle = "#ffccff";
ctx.fillText("17ec084", 2500, 3000);
ctx.restore();
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.beginPath();
ctx.arc(2000, 3500, 500, 0, 2*Math.PI, false);
ctx.stroke();
ctx.fillStyle = "#aa0000";
ctx.fill();
ctx = document.getElementById("cv").getContext("2d");
ctx.font = "150px 'ＭＳ ゴシック'";
ctx.textAlign = "center";
ctx.textBaseline = "middle";
ctx.fillStyle = "#ffffff";
ctx.fillText("sample", 2000, 3500);
ctx.restore();
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.lineWidth = 50;
ctx.strokeStyle = "#FF0000";
ctx.fillStyle = "#FF0000";
ctx.beginPath();
ctx.moveTo(2500, 2500);
ctx.lineTo(3000, 2500);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(2900, 2400);
ctx.lineTo(3000, 2500);
ctx.lineTo(2900, 2600);
ctx.stroke();
ctx.restore();
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.lineWidth = 10;
ctx.strokeStyle = "#00FF00";
ctx.fillStyle = "#00FF00";
ctx.beginPath();
ctx.moveTo(3000, 2500);
ctx.lineTo(3393.933982822, 2106.066017178);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(3287.867965644, 2000);
ctx.lineTo(3500, 2000);
ctx.lineTo(3500, 2212.132034356);
ctx.closePath();
ctx.stroke();
ctx.restore();
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.lineWidth = 30;
ctx.strokeStyle = "#0000FF";
ctx.fillStyle = "#0000FF";
ctx.beginPath();
ctx.moveTo(3500, 2000);
ctx.lineTo(3070.7106781187, 1570.7106781187);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(3000, 1570.7106781187);
ctx.lineTo(3000, 1500);
ctx.lineTo(3070.7106781187, 1500);
ctx.lineTo(3070.7106781187, 1570.7106781187);
ctx.closePath();
ctx.stroke();
ctx.restore();
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.lineWidth = 100;
ctx.strokeStyle = "#00FFFF";
ctx.fillStyle = "#00FFFF";
ctx.beginPath();
ctx.moveTo(3000, 1500);
ctx.lineTo(2500, 1500);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(2800, 1800);
ctx.lineTo(2500, 1500);
ctx.lineTo(2800, 1200);
ctx.stroke();
ctx.restore();
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.lineWidth = 30;
ctx.strokeStyle = "#FF00FF";
ctx.fillStyle = "#FF00FF";
ctx.beginPath();
ctx.moveTo(2500, 1500);
ctx.lineTo(2070.7106781187, 1929.2893218813);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(2141.4213562373, 2000);
ctx.lineTo(2000, 2000);
ctx.lineTo(2000, 1858.5786437627);
ctx.closePath();
ctx.stroke();
ctx.fill();
ctx.restore();
ctx.save();
ctx = document.getElementById("cv").getContext("2d");
ctx.lineWidth = 30;
ctx.strokeStyle = "#FFFF00";
ctx.fillStyle = "#FFFF00";
ctx.beginPath();
ctx.moveTo(2000, 2000);
ctx.lineTo(2358.5786437627, 2358.5786437627);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(2500, 2358.5786437627);
ctx.lineTo(2500, 2500);
ctx.lineTo(2358.5786437627, 2500);
ctx.lineTo(2358.5786437627, 2358.5786437627);
ctx.closePath();
ctx.stroke();
ctx.fill();
ctx.restore();
ctx.save();
document.getElementById("png").value = document.getElementById("cv").toDataURL();

xhr = new XMLHttpRequest();

xhr.open("POST", "pngGetter.php");
xhr.setRequestHeader("content-type", "application/x-www-form-urlencoded;charset=UTF-8");
xhr.send("dataurl="+encodeURIComponent(document.getElementById("png").value)+"&filename=test.png");

result = xhr.onreadystatechange = function()
{
    if(xhr.readyState === 4 && xhr.status === 200)
    {
        if(xhr.responseText == "test.png")
            alert("ここにページ遷移の処理を書く");
        else
        {
            alert("pngファイルの生成に失敗しました");
            document.write(xhr.responseText);
            xhr.abort();
        }
    }
};




</script><!-- 17ec084 end safe_script -->
</body>
</html>